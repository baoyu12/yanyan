webpackJsonp([17],{CA8z:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a={name:"ElementText",data:function(){return{textShow:!1,ready:!1,text:this.textContent,isWechat:window.isWechat,fromMini:-1!==window.location.href.indexOf("miniProgram")}},props:{id:{type:[String,Number]},css:{type:Object,required:!0},wrapCss:{type:Object,required:!0},textContent:{type:String,required:!0},properties:{type:Object,required:!0},pageIndex:{type:Number},triggers:{type:Object}},computed:{textAniList:function(){return this.properties.textAni&&this.properties.textAni.forEach(function(t,e){t.allDelay=1e3*Number(t.allDelay)}),this.properties.textAni},wrapStyle:function(){var t=["transform","left","top","width","height"],e={};for(var i in this.wrapCss)t.includes(i)&&(e[i]=this.wrapCss[i]);return e.height="auto",0==parseFloat(e.width)&&(e.width="auto"),e},shadowCss:function(){var t=this.properties;return 0==t.visible?{visibility:"hidden"}:0==t.shadowX&&0==t.shadowY&&0==t.shadowBlur?null:{boxShadow:t.shadowColor+" "+t.shadowX+"px "+t.shadowY+"px "+t.shadowBlur+"px"}},cssProperties:function(){return this.css},wrapNoSize:function(){var t=["transform","left","top","width","height"],e={};for(var i in this.wrapCss)t.includes(i)||(e[i]=this.wrapCss[i]);return e},aniOrigin:function(){var t=this.properties.aniOrigin;return"default"==t?{}:{"transform-origin":t+" !important"}}},watch:{pageIndex:{handler:function(t,e){var i=this,a=this;this.$nextTick(function(){var e=$(".ele-text[data-id="+a.id+"]").parents(".page-item").data("num");t==e?(i.ready=!0,i.judgeHide(i.textAniList),i.checkTextAni()):void 0!==i.textAniList&&i.textAniList.length>0&&"entry"==i.textAniList[0].aniType&&$("[data-id="+i.id+"]").css("opacity",0)})},immediate:!0},textAniList:{handler:function(t){void 0!==t&&this.judgeHide(t)},immediate:!0,deep:!0}},created:function(){"vertical-rl"==this.css.writingMode&&(this.css.whiteSpace="nowrap")},mounted:function(){var t=this,e=this;this.$nextTick(function(){t.$parent.fontNames.includes(t.css.fontFamily)&&$(".ele-text[data-id="+e.id+"] .text-editor").addClass(e.css.fontFamily);var i=new RegExp(/(\r\n)|(\n)|(\r)|(-n-)/g);i.test(t.text)&&(t.text=t.text.replace(i,"<br>")),-1==t.text.indexOf("<img ")&&(t.text=t.text.replace(/\s/g,"&nbsp;"))})},methods:{judgeHide:function(t){var e=this;void 0!==t&&t.length>0&&"entry"==t[0].aniType&&(this.textShow=!0,this.$nextTick(function(){$("[data-id="+e.id+"]").css("opacity",0),setTimeout(function(){$("[data-id="+e.id+"]").css("opacity",1)},t[0].allDelay)}))},textSplit:function(t){var e=this,i=this,a=this.textContent.split(""),n=new RegExp(/(\r\n)|(\n)/,"g"),s="";this.textShow=!0,a.forEach(function(t){n.test(t)?s+="<br>":e.$parent.fontNames.includes(e.css.fontFamily)?s+='<span class="animated t-hide '+e.css.fontFamily+'">'+t+"</span>":s+='<span class="animated t-hide">'+t+"</span>"}),this.$nextTick(function(){$(".ele-text[data-id="+i.id+"] .text-ani").empty(),$(".ele-text[data-id="+i.id+"] .text-ani").append(s);var e,a=$(".ele-text[data-id="+i.id+"] .text-ani > span").length,n=0;e=void 0,e=setInterval(function(){n>a-1?clearInterval(e):($(".ele-text[data-id="+i.id+"] .text-ani > span").eq(n).addClass("t-show "+t.animate),$(".ele-text[data-id="+i.id+"] .text-ani > span").eq(n).css("animation-duration",t.duration+"s"),n++)},50)})},checkTextAni:function(){var t=this,e=this,i=this.textAniList;if(void 0===i)return!1;if(i.length>0)for(var a=function(a){if(i[a].loop){var n=0,s=void 0;return s=setTimeout(function t(){0==n?i[a].allDelay:(i[a].allDelay,e.textContent.length,i[a].duration),e.textSplit(i[a]),n++,clearTimeout(s),setTimeout(t,1e3)},i[a].allDelay),"break"}if(i[a].count>1)for(var r=0;r<i[a].count;r++){var o=void 0;o=0==r?i[a].allDelay:i[a].allDelay+50*t.textContent.length+1e3*i[a].duration*r,setTimeout(function(){t.textSplit(i[a])},o)}else setTimeout(function(){t.textSplit(i[a])},i[a].allDelay)},n=0;n<i.length;n++){if("break"===a(n))break}},audioPlay:function(t){var e=this;if($(".audio").removeClass("mrotate"),document.querySelector(".music-"+this.id).paused){var i=$(t.target),a=i.data("hash"),n=i.data("link");a?this.$_post(this.apiUrl+"hashToLink",{hash:a}).then(function(t){$(".audio-com").not(".music-"+e.id).each(function(){$(this)[0].pause()}),i.children("audio").attr("src",t),i.children("audio")[0].play()}):($(".audio-com").not(".music-"+e.id).each(function(){$(this)[0].pause()}),i.children("audio").attr("src",n),i.children("audio")[0].play())}else document.querySelector(".music-"+this.id).pause()},triggerFun:function(t){if("link"==this.triggers.event)window.top===window.self?window.location.href=this.triggers.link:window.parent.open(this.triggers.link);else if("phone"==this.triggers.event){var e="tel:"+this.triggers.phone;window.location.href=e}else if("page"==this.triggers.event)t.stopPropagation(),this.bus.$emit("jumpPage",this.triggers.go);else if("music"==this.triggers.event){var i=this;if($(".audio").removeClass("mrotate"),document.getElementById("music").pause(),document.querySelector(".audio-"+i.id).paused){var a=$(t.currentTarget);console.log(a);var n=a.data("hash"),s=a.data("link");console.log(s),n?i.$_post(i.apiUrl+"hashToLink",{hash:n}).then(function(t){$(".audio-bom").not(".audio-"+i.id).each(function(){$(this)[0].pause()}),$(".audio-"+i.id).attr("src",t),$(".audio-"+i.id)[0].play()}):($(".audio-bom").not(".audio-"+i.id).each(function(){$(this)[0].pause()}),$(".audio-"+i.id).attr("src",s),$(".audio-"+i.id)[0].play())}else document.querySelector(".audio-"+i.id).pause()}else if("tip"==this.triggers.event){if(-1!==window.location.href.indexOf("miniProgram"))window.isDouyin?tt.miniProgram.switchTab({url:"/pages/index/index"}):uni.switchTab({url:"/pages/index/index"});else{if(window.newApp||window.newAndroid)return;window.location.href="https://h5.hunbei.com/appdown?from=footer"}}}}},n={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"ele-text",style:t.wrapStyle},[i("div",{staticClass:"ani-wrap",style:[t.wrapNoSize,t.shadowCss,t.aniOrigin]},[""==t.triggers.event?[t.properties.musicLink||t.properties.musicHash?i("div",{staticClass:"audio-wrap",attrs:{"data-link":t.properties.musicLink,"data-hash":t.properties.musicHash},on:{click:function(e){t.audioPlay(e)}}},[i("audio",{staticClass:"audio-com",class:"music-"+t.id})]):t._e()]:t._e(),t._v(" "),"phone"==t.triggers.event?i("a",{attrs:{href:"tel:"+t.triggers.phone,id:t.id+"tel"}}):t._e(),t._v(" "),"tip"==t.triggers.event&&t.isWechat&&!t.fromMini?i("wx-open-launch-weapp",{staticStyle:{display:"block",width:"100%",height:"100%",position:"absolute","z-index":"1",top:"0",left:"0"},attrs:{id:"launch-btn",username:"gh_c6b704259411",path:"pages/index/index"}},[i("script",{attrs:{type:"text/wxtag-template"}},[t._v("\n                    <style>.x-div { width: 100%; height: auto;opacity:0;}</style><div class='x-div'>我也要制作</div>")])]):t._e(),t._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:t.textShow,expression:"textShow"}],staticClass:"text-common text-ani",style:t.css,attrs:{"data-link":t.triggers.musicLink,"data-hash":t.triggers.musicHash},on:{click:function(e){e.stopPropagation(),t.triggerFun(e)}}}),t._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:!t.textShow,expression:"!textShow"}],staticClass:"text-common text-editor",style:t.css,attrs:{"data-link":t.triggers.musicLink,"data-hash":t.triggers.musicHash},domProps:{innerHTML:t._s(t.text)},on:{click:function(e){t.triggerFun(e)}}}),t._v(" "),"music"==t.triggers.event?i("audio",{staticClass:"audio-bom",class:"audio-"+t.id}):t._e()],2)])},staticRenderFns:[]};var s=i("VU/8")(a,n,!1,function(t){i("a9bE")},null,null);e.default=s.exports},a9bE:function(t,e){}});